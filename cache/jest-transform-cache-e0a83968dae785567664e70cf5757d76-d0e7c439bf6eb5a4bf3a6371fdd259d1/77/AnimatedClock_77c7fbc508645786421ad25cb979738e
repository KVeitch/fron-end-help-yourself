4e67e3ca706504206997644fc306f045
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.clock = exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _get2 = _interopRequireDefault(require("@babel/runtime/helpers/get"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _AnimatedValue = _interopRequireDefault(require("./AnimatedValue"));

var _AnimatedNode2 = _interopRequireDefault(require("./AnimatedNode"));

var _val = require("../val");

var AnimatedMainClock = function (_InternalAnimatedValu) {
  (0, _inherits2.default)(AnimatedMainClock, _InternalAnimatedValu);

  function AnimatedMainClock() {
    var _this;

    (0, _classCallCheck2.default)(this, AnimatedMainClock);
    _this = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(AnimatedMainClock).call(this, {
      type: 'MAIN_CLOCK'
    }));

    _this._runFrame = function () {
      _this._updateValue(0);

      if (_this.__children.length > 0) {
        _this._frameCallback = requestAnimationFrame(_this._runFrame);
      }
    };

    return _this;
  }

  (0, _createClass2.default)(AnimatedMainClock, [{
    key: "__onEvaluate",
    value: function __onEvaluate() {
      return +new Date();
    }
  }, {
    key: "__attach",
    value: function __attach() {
      (0, _get2.default)((0, _getPrototypeOf2.default)(AnimatedMainClock.prototype), "__attach", this).call(this);

      if (!this._frameCallback) {
        this._frameCallback = requestAnimationFrame(this._runFrame);
      }
    }
  }, {
    key: "__detach",
    value: function __detach() {
      if (this._frameCallback) {
        cancelAnimationFrame(this._frameCallback);
        this._frameCallback = null;
      }

      (0, _get2.default)((0, _getPrototypeOf2.default)(AnimatedMainClock.prototype), "__detach", this).call(this);
    }
  }]);
  return AnimatedMainClock;
}(_AnimatedValue.default);

var mainClock = new AnimatedMainClock();

var AnimatedClock = function (_AnimatedNode) {
  (0, _inherits2.default)(AnimatedClock, _AnimatedNode);

  function AnimatedClock() {
    (0, _classCallCheck2.default)(this, AnimatedClock);
    return (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(AnimatedClock).call(this, {
      type: 'clock'
    }));
  }

  (0, _createClass2.default)(AnimatedClock, [{
    key: "__onEvaluate",
    value: function __onEvaluate() {
      return (0, _val.val)(mainClock);
    }
  }, {
    key: "__attach",
    value: function __attach() {
      (0, _get2.default)((0, _getPrototypeOf2.default)(AnimatedClock.prototype), "__attach", this).call(this);

      if (this._started && !this._attached) {
        mainClock.__addChild(this);
      }

      this._attached = true;
    }
  }, {
    key: "__detach",
    value: function __detach() {
      if (this._started && this._attached) {
        mainClock.__removeChild(this);
      }

      this._attached = false;
      (0, _get2.default)((0, _getPrototypeOf2.default)(AnimatedClock.prototype), "__detach", this).call(this);
    }
  }, {
    key: "start",
    value: function start() {
      if (!this._started && this._attached) {
        mainClock.__addChild(this);
      }

      this._started = true;
    }
  }, {
    key: "stop",
    value: function stop() {
      if (this._started && this._attached) {
        mainClock.__removeChild(this);
      }

      this._started = false;
    }
  }, {
    key: "isStarted",
    value: function isStarted() {
      return this._started;
    }
  }]);
  return AnimatedClock;
}(_AnimatedNode2.default);

exports.default = AnimatedClock;
var clock = mainClock;
exports.clock = clock;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFuaW1hdGVkQ2xvY2suanMiXSwibmFtZXMiOlsiQW5pbWF0ZWRNYWluQ2xvY2siLCJ0eXBlIiwiX3J1bkZyYW1lIiwiX3VwZGF0ZVZhbHVlIiwiX19jaGlsZHJlbiIsImxlbmd0aCIsIl9mcmFtZUNhbGxiYWNrIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiRGF0ZSIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwiSW50ZXJuYWxBbmltYXRlZFZhbHVlIiwibWFpbkNsb2NrIiwiQW5pbWF0ZWRDbG9jayIsIl9zdGFydGVkIiwiX2F0dGFjaGVkIiwiX19hZGRDaGlsZCIsIl9fcmVtb3ZlQ2hpbGQiLCJBbmltYXRlZE5vZGUiLCJjbG9jayJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztJQUVNQSxpQjs7O0FBR0osK0JBQWM7QUFBQTs7QUFBQTtBQUNaLHVIQUFNO0FBQUVDLE1BQUFBLElBQUksRUFBRTtBQUFSLEtBQU47O0FBRFksVUFRZEMsU0FSYyxHQVFGLFlBQU07QUFDaEIsWUFBS0MsWUFBTCxDQUFrQixDQUFsQjs7QUFDQSxVQUFJLE1BQUtDLFVBQUwsQ0FBZ0JDLE1BQWhCLEdBQXlCLENBQTdCLEVBQWdDO0FBQzlCLGNBQUtDLGNBQUwsR0FBc0JDLHFCQUFxQixDQUFDLE1BQUtMLFNBQU4sQ0FBM0M7QUFDRDtBQUNGLEtBYmE7O0FBQUE7QUFFYjs7OzttQ0FFYztBQUNiLGFBQU8sQ0FBQyxJQUFJTSxJQUFKLEVBQVI7QUFDRDs7OytCQVNVO0FBQ1Q7O0FBQ0EsVUFBSSxDQUFDLEtBQUtGLGNBQVYsRUFBMEI7QUFDeEIsYUFBS0EsY0FBTCxHQUFzQkMscUJBQXFCLENBQUMsS0FBS0wsU0FBTixDQUEzQztBQUNEO0FBQ0Y7OzsrQkFFVTtBQUNULFVBQUksS0FBS0ksY0FBVCxFQUF5QjtBQUN2QkcsUUFBQUEsb0JBQW9CLENBQUMsS0FBS0gsY0FBTixDQUFwQjtBQUNBLGFBQUtBLGNBQUwsR0FBc0IsSUFBdEI7QUFDRDs7QUFDRDtBQUNEOzs7RUEvQjZCSSxzQjs7QUFrQ2hDLElBQU1DLFNBQVMsR0FBRyxJQUFJWCxpQkFBSixFQUFsQjs7SUFFcUJZLGE7OztBQUluQiwyQkFBYztBQUFBO0FBQUEsa0hBQ047QUFBRVgsTUFBQUEsSUFBSSxFQUFFO0FBQVIsS0FETTtBQUViOzs7O21DQUVjO0FBQ2IsYUFBTyxjQUFJVSxTQUFKLENBQVA7QUFDRDs7OytCQUVVO0FBQ1Q7O0FBQ0EsVUFBSSxLQUFLRSxRQUFMLElBQWlCLENBQUMsS0FBS0MsU0FBM0IsRUFBc0M7QUFDcENILFFBQUFBLFNBQVMsQ0FBQ0ksVUFBVixDQUFxQixJQUFyQjtBQUNEOztBQUNELFdBQUtELFNBQUwsR0FBaUIsSUFBakI7QUFDRDs7OytCQUVVO0FBQ1QsVUFBSSxLQUFLRCxRQUFMLElBQWlCLEtBQUtDLFNBQTFCLEVBQXFDO0FBQ25DSCxRQUFBQSxTQUFTLENBQUNLLGFBQVYsQ0FBd0IsSUFBeEI7QUFDRDs7QUFDRCxXQUFLRixTQUFMLEdBQWlCLEtBQWpCO0FBQ0E7QUFDRDs7OzRCQUVPO0FBQ04sVUFBSSxDQUFDLEtBQUtELFFBQU4sSUFBa0IsS0FBS0MsU0FBM0IsRUFBc0M7QUFDcENILFFBQUFBLFNBQVMsQ0FBQ0ksVUFBVixDQUFxQixJQUFyQjtBQUNEOztBQUNELFdBQUtGLFFBQUwsR0FBZ0IsSUFBaEI7QUFDRDs7OzJCQUVNO0FBQ0wsVUFBSSxLQUFLQSxRQUFMLElBQWlCLEtBQUtDLFNBQTFCLEVBQXFDO0FBQ25DSCxRQUFBQSxTQUFTLENBQUNLLGFBQVYsQ0FBd0IsSUFBeEI7QUFDRDs7QUFDRCxXQUFLSCxRQUFMLEdBQWdCLEtBQWhCO0FBQ0Q7OztnQ0FFVztBQUNWLGFBQU8sS0FBS0EsUUFBWjtBQUNEOzs7RUE1Q3dDSSxzQjs7O0FBK0MzQyxJQUFNQyxLQUFLLEdBQUdQLFNBQWQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgSW50ZXJuYWxBbmltYXRlZFZhbHVlIGZyb20gJy4vQW5pbWF0ZWRWYWx1ZSc7XG5pbXBvcnQgQW5pbWF0ZWROb2RlIGZyb20gJy4vQW5pbWF0ZWROb2RlJztcbmltcG9ydCB7IHZhbCB9IGZyb20gJy4uL3ZhbCc7XG5cbmNsYXNzIEFuaW1hdGVkTWFpbkNsb2NrIGV4dGVuZHMgSW50ZXJuYWxBbmltYXRlZFZhbHVlIHtcbiAgX2ZyYW1lQ2FsbGJhY2s7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoeyB0eXBlOiAnTUFJTl9DTE9DSycgfSk7XG4gIH1cblxuICBfX29uRXZhbHVhdGUoKSB7XG4gICAgcmV0dXJuICtuZXcgRGF0ZSgpO1xuICB9XG5cbiAgX3J1bkZyYW1lID0gKCkgPT4ge1xuICAgIHRoaXMuX3VwZGF0ZVZhbHVlKDApO1xuICAgIGlmICh0aGlzLl9fY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5fZnJhbWVDYWxsYmFjayA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLl9ydW5GcmFtZSk7XG4gICAgfVxuICB9O1xuXG4gIF9fYXR0YWNoKCkge1xuICAgIHN1cGVyLl9fYXR0YWNoKCk7XG4gICAgaWYgKCF0aGlzLl9mcmFtZUNhbGxiYWNrKSB7XG4gICAgICB0aGlzLl9mcmFtZUNhbGxiYWNrID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuX3J1bkZyYW1lKTtcbiAgICB9XG4gIH1cblxuICBfX2RldGFjaCgpIHtcbiAgICBpZiAodGhpcy5fZnJhbWVDYWxsYmFjaykge1xuICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5fZnJhbWVDYWxsYmFjayk7XG4gICAgICB0aGlzLl9mcmFtZUNhbGxiYWNrID0gbnVsbDtcbiAgICB9XG4gICAgc3VwZXIuX19kZXRhY2goKTtcbiAgfVxufVxuXG5jb25zdCBtYWluQ2xvY2sgPSBuZXcgQW5pbWF0ZWRNYWluQ2xvY2soKTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQW5pbWF0ZWRDbG9jayBleHRlbmRzIEFuaW1hdGVkTm9kZSB7XG4gIF9zdGFydGVkO1xuICBfYXR0YWNoZWQ7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoeyB0eXBlOiAnY2xvY2snIH0pO1xuICB9XG5cbiAgX19vbkV2YWx1YXRlKCkge1xuICAgIHJldHVybiB2YWwobWFpbkNsb2NrKTtcbiAgfVxuXG4gIF9fYXR0YWNoKCkge1xuICAgIHN1cGVyLl9fYXR0YWNoKCk7XG4gICAgaWYgKHRoaXMuX3N0YXJ0ZWQgJiYgIXRoaXMuX2F0dGFjaGVkKSB7XG4gICAgICBtYWluQ2xvY2suX19hZGRDaGlsZCh0aGlzKTtcbiAgICB9XG4gICAgdGhpcy5fYXR0YWNoZWQgPSB0cnVlO1xuICB9XG5cbiAgX19kZXRhY2goKSB7XG4gICAgaWYgKHRoaXMuX3N0YXJ0ZWQgJiYgdGhpcy5fYXR0YWNoZWQpIHtcbiAgICAgIG1haW5DbG9jay5fX3JlbW92ZUNoaWxkKHRoaXMpO1xuICAgIH1cbiAgICB0aGlzLl9hdHRhY2hlZCA9IGZhbHNlO1xuICAgIHN1cGVyLl9fZGV0YWNoKCk7XG4gIH1cblxuICBzdGFydCgpIHtcbiAgICBpZiAoIXRoaXMuX3N0YXJ0ZWQgJiYgdGhpcy5fYXR0YWNoZWQpIHtcbiAgICAgIG1haW5DbG9jay5fX2FkZENoaWxkKHRoaXMpO1xuICAgIH1cbiAgICB0aGlzLl9zdGFydGVkID0gdHJ1ZTtcbiAgfVxuXG4gIHN0b3AoKSB7XG4gICAgaWYgKHRoaXMuX3N0YXJ0ZWQgJiYgdGhpcy5fYXR0YWNoZWQpIHtcbiAgICAgIG1haW5DbG9jay5fX3JlbW92ZUNoaWxkKHRoaXMpO1xuICAgIH1cbiAgICB0aGlzLl9zdGFydGVkID0gZmFsc2U7XG4gIH1cblxuICBpc1N0YXJ0ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3N0YXJ0ZWQ7XG4gIH1cbn1cblxuY29uc3QgY2xvY2sgPSBtYWluQ2xvY2s7XG5leHBvcnQgeyBjbG9jayB9O1xuIl19